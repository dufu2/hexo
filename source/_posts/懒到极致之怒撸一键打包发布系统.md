---
title: æ‡’åˆ°æè‡´ä¹‹æ€’æ’¸ä¸€é”®æ‰“åŒ…å‘å¸ƒç³»ç»Ÿ
date: 2018-04-20
updated: 2018-04-20
---


ä¸€åˆ‡å¾—ä»ä¸Šä¸ªç‰ˆæœ¬çš„æ‰“åŒ…å‘å¸ƒè¯´èµ·ã€‚

å¼€å‘ä¸­æœ¬äººè´Ÿè´£äº†iOSåŒ…çš„ç‰ˆæœ¬å‘å¸ƒå·¥ä½œã€‚iOSæ‰“åŒ…ï¼šä¸å°±æ˜¯é€‰ä¸€ä¸‹è¯ä¹¦ï¼Œå†åœ¨Xcodeä¸Šç‚¹å‡ ä¸‹æŒ‰é’®ï¼ŒIDEå…¨éƒ½ç»™ä½ è®¾ç½®å¥½æµç¨‹äº†ï¼Œæœ‰å¿…è¦è¿™ä¹ˆéº»çƒ¦å—ï¼Ÿ

è¯šç„¶ï¼Œå¦‚æœåªæ˜¯æ‰“åŒ…ï¼Œåœ¨ä¸è€ƒè™‘å›¢é˜ŸååŒåˆä½œã€æ‰“åŒ…æ•ˆç‡ã€é‡å¤å·¥ä½œé‡çš„å‰æä¸‹ï¼Œä½¿ç”¨Xcodeè‡ªå¸¦çš„æ‰“åŒ…æ–¹å¼å½“ç„¶æ˜¯æ²¡é—®é¢˜çš„ã€‚ä½†å®é™…å¼€å‘ä¸­ï¼Œæ¯æ¬¡æ‰“åŒ…å¤§æ¦‚åŒ…å«ä»¥ä¸‹æµç¨‹ï¼š
`æ‹‰å–æœ€æ–°ä»£ç ï¼ˆSVNæˆ–Gitï¼‰` â†’ `ç¼–è¯‘é€šè¿‡` â†’ `è®¾ç½®æ‰“åŒ…ç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ï¼‰` â†’ `å¯¼å‡ºIPAåŒ…` â†’ `ä¸Šä¼ IPAåŒ…ï¼ˆApp Storeæˆ–è€…ä¼ä¸šåŒ…ä¸Šä¼ è‡³æŒ‡å®šæœåŠ¡å™¨ï¼‰`

<!-- more -->

å¯ä»¥çœ‹å‡ºï¼Œå…¶ä¸­çš„å¾ˆå¤šæ­¥éª¤éƒ½æ˜¯æœºæ¢°é‡å¤çš„ï¼Œç‰¹åˆ«å½“è¿›å…¥æµ‹è¯•éªŒæ”¶é˜¶æ®µï¼Œæœ‰æ—¶æ¯ä¿®å¤å‡ ä¸ªbugå°±è¦é‡æ–°æ‰“åŒ…å‘å¸ƒæµ‹è¯•ï¼Œæ¯”å¦‚ä¸Šä¸ªç‰ˆæœ¬çš„æ—¶å€™æ–°åŠŸèƒ½ä¸»è¦æ˜¯é˜Ÿå‹åœ¨å¼€å‘ï¼Œæµ‹è¯•åˆ°æœ€åé¢‘ç¹åœ°è®©æˆ‘æ‰“åŒ…å‘å¸ƒï¼Œä¸åœåœ°æ‰“æ–­æˆ‘çš„å·¥ä½œå»é‡å¤æœºæ¢°çš„äº‹æƒ…ï¼Œè¿™ç®€ç›´å°±æ˜¯åœ¨æµªè´¹äººç”Ÿå•Šï¼ï¼ï¼ğŸ˜¤ğŸ˜¤ğŸ˜¤

è™½ç„¶ä¹‹å‰ä¸ºäº†æ‰“åŒ…æ–¹ä¾¿ï¼Œæˆ‘å·²ç»æ•´ç†äº†ä¸€ä»½è„šæœ¬æ‰“åŒ…çš„æµç¨‹ï¼ˆä¼ é€é—¨ï¼š[Shellè„šæœ¬â€”â€”Xcodeè„šæœ¬æ‰“åŒ…](http://lele8446.top/2016/06/20/Shellè„šæœ¬â€”â€”Xcodeè„šæœ¬æ‰“åŒ…/)ï¼‰ï¼Œä½†è¿˜æ˜¯ä¸å¤Ÿæ–¹ä¾¿å¿«æ·ï¼Œä¹˜ç€æ–°ç‰ˆå‘å¸ƒåçš„ç©ºæ¡£æœŸï¼Œæ’¸å‡º **ä¸€é”®æ‰“åŒ…å‘å¸ƒç³»ç»Ÿ** ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š
`è‡ªåŠ¨æ‹‰å–Gitæœ€æ–°ä»£ç ` â†’ `è‡ªåŠ¨é€‰æ‹©ç­¾åè¯ä¹¦å¹¶æ‰“åŒ…å¯¼å‡ºipaæ–‡ä»¶` â†’ `Gitè‡ªåŠ¨åŒæ­¥ä»£ç `â†’  `è‡ªåŠ¨ä¸Šä¼ ipaåŒ…ï¼ˆæˆ‘ä»¬æ˜¯ä¼ä¸šåŒ…ï¼Œä¸Šä¼ è‡³è‡ªå·±çš„æœåŠ¡å™¨ï¼Œè¿™ä¸€æ­¥æ˜¯å¯é€‰çš„ï¼‰`

***
### ä¸€é”®æ‰“åŒ…
[é¡¹ç›®é“¾æ¥åœ°å€](https://github.com/lele8446/CJShellDemo/tree/master/ArchiveSource)

##### ä¸€é”®æ‰“åŒ…èµ„æºï¼ˆArchiveSourceï¼‰ç®€ä»‹ï¼š
* Codeæ–‡ä»¶å¤¹ä¸‹æ˜¯æ‰“åŒ…åº”ç”¨ç¨‹åºæºä»£ç 
* Sourceæ–‡ä»¶å¤¹ä¸‹æ˜¯æ‰“åŒ…èµ„æº

 Sourceæ–‡ä»¶å¤¹ï¼š
 1. Archive.appï¼ˆæ‰“åŒ…åº”ç”¨ç¨‹åºï¼‰
 2. ExportOptions.plistï¼ˆå¯¼å‡ºipaåŒ…é…ç½®æ–‡ä»¶ï¼‰

##### ä¸€é”®æ‰“åŒ…æ­¥éª¤ï¼š
1. è¿›å…¥Sourceæ–‡ä»¶å¤¹ï¼Œå¯åŠ¨ Archive åº”ç”¨ç¨‹åº
2. é€‰æ‹© .xcodeproj æˆ– .xcworkspace æ–‡ä»¶
3. ä¿®æ”¹æ‰“åŒ…ç‰ˆæœ¬å·ã€‚
å¯åŠ¨Xcodeï¼Œæ‰‹åŠ¨é€‰æ‹©ç­¾åè¯ä¹¦ï¼ˆå¦‚æœé»˜è®¤ç­¾åå¤±è´¥çš„è¯ï¼‰
4. ç‚¹å‡»æ‰“åŒ…

##### æ‰“åŒ…ç”Ÿæˆçš„IPAåŒ…è·¯å¾„è¯´æ˜ï¼š
`../é¡¹ç›®æ‰€åœ¨è·¯å¾„/Archiving/ï¼ˆä»¥AppIdå‘½åçš„æ–‡ä»¶å¤¹ï¼‰/ï¼ˆAppå+ç‰ˆæœ¬å·å‘½åçš„æ–‡ä»¶å¤¹ï¼‰/ï¼ˆä»¥æ‰“åŒ…æ—¶é—´å‘½åçš„æ–‡ä»¶å¤¹ï¼‰`

ç¤ºä¾‹ï¼š
`../Archiving/(AppID)/(Appå)_3_1_29/2018_04_10_11:18:51`

***
### ä¸€é”®æ‰“åŒ…åŸç†

ä¸€é”®æ‰“åŒ…å‘å¸ƒç³»ç»Ÿå…¶å®å¾ˆç®€å•ï¼šå¼€å‘ä¸€æ¬¾Macåº”ç”¨ï¼Œåº”ç”¨å¯åŠ¨æ—¶è¯»å–æœ¬æœºå·²æœ‰çš„Certificateså’ŒProvisioning Profilesä¿¡æ¯ï¼Œå†åœ¨åº”ç”¨å†…è°ƒç”¨Shellè„šæœ¬ï¼Œä¸»è¦é€šè¿‡è„šæœ¬æ¥å®ç°GitåŒæ­¥ä»¥åŠæ‰“åŒ…çš„ç›¸å…³æ“ä½œã€‚

* ##### Shellè„šæœ¬è°ƒç”¨
Objective-Cä¸­è°ƒç”¨Shellè„šæœ¬å¯ä»¥ä½¿ç”¨ **NSTask** ã€‚é€šè¿‡NSTaskï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ä¸­è°ƒç”¨å¦ä¸€ä¸ªç¨‹åºæˆ–è¿è¡Œä¸€æ®µè„šæœ¬å¹¶è·å¾—å…¶æ‰§è¡ŒçŠ¶æ€å’Œæœ€ç»ˆç»“æœï¼ŒNSTaskæœ€ä¸ºå¸¸ç”¨çš„ä¸€ä¸ªåœºæ™¯æ˜¯ä¸ºå‘½ä»¤è¡Œæ“ä½œæä¾›å›¾å½¢åŒ–çš„ç•Œé¢ã€‚

        //åˆ›å»ºä¸€ä¸ªæ–°çš„Task
        NSTask *optTask = [[NSTask alloc] init];
        //è®¾ç½®è°ƒç”¨è·¯å¾„
        optTask.launchPath = shellPath;
        //è®¾ç½®è°ƒç”¨å‚æ•°(è¢«è°ƒç”¨ç¨‹åºå‘½ä»¤)
        optTask.arguments = @[@"-ls"];
        //åˆ›å»ºè¾“å‡ºPipe
        NSPipe *outputPipe = [NSPipe pipe];
        [optTask setStandardOutput:outputPipe];
        //åˆ›å»ºé”™è¯¯è¾“å‡ºPipe
        NSPipe *errorPipe = [NSPipe pipe];
        [optTask setStandardError:errorPipe];

        //æ‰§è¡Œå®ŒæˆBlock é€šçŸ¥
        optTask.terminationHandler = ^(NSTask *theTask) {
            [theTask.standardOutput fileHandleForReading].readabilityHandler = nil;
            [theTask.standardError fileHandleForReading].readabilityHandler = nil;
        };

        //é”™è¯¯è¾“å‡º
        [[errorPipe fileHandleForReading] setReadabilityHandler:^(NSFileHandle *file) {
            NSData *data = [file availableData];
            NSString *errorMsg = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
            NSLog(@"errorMsg = %@",errorMsg);
            
        }];
        //æ‰§è¡Œç»“æœè¾“å‡º
        [[outputPipe fileHandleForReading] setReadabilityHandler:^(NSFileHandle *file) {
            NSData *data = [file availableData];
            NSString *msg = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
            NSLog(@"msg = %@",msg);
        }];

        //å¼€å¯æ‰§è¡Œ
        [optTask launch];
        //é˜»å¡ç›´åˆ°æ‰§è¡Œå®Œæ¯•ï¼ˆNSTaské»˜è®¤æ˜¯å¼‚æ­¥æ‰§è¡Œ,å¦‚æœæœ‰åŒæ­¥éœ€æ±‚,å¯è°ƒç”¨waitUntilExit()æ–¹æ³•ï¼‰
        [optTask waitUntilExit];

        [[outputPipe fileHandleForReading] closeFile];
        [[errorPipe fileHandleForReading] closeFile];

* ##### è‡ªåŠ¨é€‰æ‹©ç­¾åè¯ä¹¦
è·å–ç”µè„‘ä¸­ä»¥`iPhone Distribution`å’Œ`iPhone Developer`å‘½åå¼€å¤´çš„Certificatesï¼š

	    + (void)loadCerListBlock:(CerListBlock)listBlock {
	        NSDictionary *options = @{(__bridge id)kSecClass: (__bridge id)kSecClassCertificate,
	                                  (__bridge id)kSecMatchLimit: (__bridge id)kSecMatchLimitAll};
	        CFArrayRef certs = NULL;
	        __unused OSStatus status = SecItemCopyMatching((__bridge CFDictionaryRef)options, (CFTypeRef *)&certs);
	        NSArray *certificates = CFBridgingRelease(certs);
	
	        NSMutableArray  *tempArray=[NSMutableArray array];
	        for (int i=0;i<[certificates count];i++) {
	            SecCertificateRef  certificate = (__bridge SecCertificateRef)([certificates objectAtIndex:i]);
	            NSString *name =  CFBridgingRelease(SecCertificateCopySubjectSummary(certificate));
	
	            if ([name hasPrefix:@"iPhone Distribution"]||[name hasPrefix:@"iPhone Developer"]) {
	                [tempArray addObject:name];
	            }
	        }
	        listBlock(tempArray);
	    }

	è·å–ç”µè„‘ä¸­Provisioning Profilesï¼š

	    //è·å–ç”µè„‘ä¸­æ»¡è¶³æ¡ä»¶çš„Provisioning Profilesçš„è·¯å¾„
	    + (NSArray *)getAllProvisioningProfileList{
	        NSString  *path=[NSString stringWithFormat:@"%@/%@", NSHomeDirectory(), kMobileprovisionDirName];
	        
	        NSFileManager *fileManager=[NSFileManager defaultManager];
	        
	        NSArray *provisioningProfiles =[fileManager contentsOfDirectoryAtPath:path error:nil];
	        provisioningProfiles = [provisioningProfiles filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"pathExtension IN %@",  @[@"mobileprovision", @"provisionprofile"]]];
	        
	        return provisioningProfiles;
	    }
	
	    //è‡ªå®šä¹‰ YAProvisioningProfile ï¼Œå°†profileè½¬æ¢ä¸ºå¯¹åº”å®ä½“
	    YAProvisioningProfile *profile = [[YAProvisioningProfile alloc] initWithPath:path];

	æ ¹æ®App IDåŒ¹é… Profile æè¿°æ–‡ä»¶ï¼š

		//æ ¹æ®appBundleIdentifieråŒ¹é… profile æè¿°æ–‡ä»¶
		YAProvisioningProfile *selectProfile = nil;
		for (YAProvisioningProfile *profile in profileArray) {
		    // æŸ¥æ‰¾ä¸bundleIdentifierç›¸ç­‰ï¼Œæè¿°æ–‡ä»¶ä¸ä»¥ XC: å‘½åå¼€å¤´ï¼Œè€Œä¸”æ˜¯æœ€æ–°çš„æ–‡ä»¶
		    if ([profile.bundleIdentifier isEqualToString:appBundleIdentifier] && ![profile.name hasPrefix:@"XC:"] && profile.newest) {
		        selectProfile = profile;
		        break;
		    }
		}

* ##### è¯»å†™Xcodeå·¥ç¨‹é…ç½®
å³é”® XXX.xcodeproj æ–‡ä»¶ï¼Œæ˜¾ç¤ºåŒ…å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°`project.pbxproj`ã€‚`project.pbxproj`å­˜å‚¨ç€ Xcode å·¥ç¨‹çš„å„é¡¹é…ç½®å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬æ¥ç›´æ¥è¯»å–æˆ–ä¿®æ”¹å…¶é…ç½®ï¼Œæ‰§è¡Œæ•ˆæœç­‰åŒäºåœ¨Xcodeçš„Generalã€Build Settingsä¸­çš„ä¿®æ”¹ã€‚

	è¯»å–App Bundler Identifierï¼š

		# Pbxproj_PathæŒ‡å‘ project.pbxproj æ–‡ä»¶è·¯å¾„
		configuration=$(grep -i "PRODUCT_BUNDLE_IDENTIFIER =" ${Pbxproj_Path})
		Array=($(echo $configuration))
		# project.pbxproj ä¸­å­˜åœ¨å¤šè¡ŒPRODUCT_BUNDLE_IDENTIFIERä¿¡æ¯ï¼Œä»åå¾€å‰è¯»å–
		Bundle_Identifier=${Array[5]}
		if [ ! -n $Bundle_Identifier ]
		then
		    Bundle_Identifier=${Array[3]}
		fi
		echo "Bundle_Identifier = ${Bundle_Identifier}"

	ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼š
ä¿®æ”¹ project.pbxproj é…ç½®å¯ä»¥é€šè¿‡ `sed` å‘½ä»¤å®ç°ï¼Œæ¯”å¦‚å°†ç­¾åç±»å‹æŒ‡å®šä¸ºManual

		key="CODE_SIGN_STYLE"
		value="Manual;"
		# ä¿®æ”¹ project.pbxproj é…ç½®ï¼ŒæŒ‡å®šç­¾åç±»å‹ä¸ºæ‰‹åŠ¨é€‰æ‹©
		sed -i "" "s/$key =.*$/$key = $value/g" $Pbxproj_Path

	å¦‚æœç¨‹åºæˆåŠŸè¯»å–åˆ°å¯¹åº”çš„è¯ä¹¦ç­¾åï¼Œé‚£ä¹ˆæ‰“åŒ…å‰éœ€è¦ä¿®æ”¹çš„é…ç½®åŒ…æ‹¬ï¼š

		#ä¿®æ”¹ PRODUCT_BUNDLE_IDENTIFIER
		changeConfiguration "PRODUCT_BUNDLE_IDENTIFIER" "${APP_ID};"
	
		#ä¿®æ”¹ PROVISIONING_PROFILE
		changeConfiguration "PROVISIONING_PROFILE" "\"${Profile_Name}\";"
	
		#ä¿®æ”¹ PROVISIONING_PROFILE_SPECIFIER
		changeConfiguration "PROVISIONING_PROFILE_SPECIFIER" "${Profile_Specifier};"
	
		#ä¿®æ”¹ PRODUCT_NAME
		changeConfiguration "PRODUCT_NAME" "${Scheme_Name};"
	
		#ä¿®æ”¹ "CODE_SIGN_IDENTITY[sdk=iphoneos*]"
		changeConfiguration "\"CODE_SIGN_IDENTITY\[sdk=iphoneos\*\]\"" '"iPhone Distribution";'
	
		#ä¿®æ”¹ CODE_SIGN_STYLE
		changeConfiguration "CODE_SIGN_STYLE" "Manual;"
	
		#ä¿®æ”¹ ProvisioningStyle
		changeConfiguration "ProvisioningStyle" "Manual;"
		
		#ä¿®æ”¹ DEVELOPMENT_TEAM
		changeConfiguration "DEVELOPMENT_TEAM" "${Development_Team};"
	
		#ä¿®æ”¹ DevelopmentTeam
		changeConfiguration "DevelopmentTeam" "${Development_Team};"

	ä¿®æ”¹é¡¹ç›®ç‰ˆæœ¬å·ï¼š
Info.plistæ–‡ä»¶ä¸­`CFBundleShortVersionString`å¯¹åº”Versionå·ï¼Œ`CFBundleVersion`å¯¹åº”Buildå·ï¼Œä½¿ç”¨è„šæœ¬å¯ä»¥ç›´æ¥æŒ‡å®šç‰ˆæœ¬å·

		# info.plistæ–‡ä»¶è·¯å¾„
		InfoPlist_Path="${Project_Path}/${App_Name}/Info.plist"
		# å¦‚æœæ˜¯æ—§çš„é¡¹ç›®ï¼Œinfo.plistæ–‡ä»¶å¯¹åº”çš„åå­—ä¸º (App_Name)-Info.plist
		if [ ! -e "${InfoPlist_Path}" ];then
			InfoPlist_Path="${Project_Path}/${App_Name}/${App_Name}-Info.plist"
		fi
	
		/usr/libexec/PlistBuddy -c "Set :CFBundleShortVersionString ${Version_String}"  ${InfoPlist_Path}
		/usr/libexec/PlistBuddy -c "Set :CFBundleVersion ${Version_String}" ${InfoPlist_Path}

* ##### æ‰“åŒ…é¡¹ç›®


		# æŒ‡å®šæ‰“åŒ…æ¨¡å¼ä¸ºRelease
		Configuration="Release"
		# åˆ¤æ–­ç¼–è¯‘çš„é¡¹ç›®ç±»å‹æ˜¯workspaceè¿˜æ˜¯project
		if [[ ${Is_Workspace} == "YES" ]]; then
			# ç¼–è¯‘å‰æ¸…ç†å·¥ç¨‹ï¼Œ>> ${Log_path} è¡¨ç¤ºå°†æ—¥å¿—è¾“å‡ºå†™å…¥åˆ°Log_pathæ–‡ä»¶
			xcodebuild clean -configuration "${Configuration}" -alltargets >> ${Log_path}
	
			# è‡ªå®šä¹‰ç­¾åï¼ŒæŒ‡å®šç­¾åè¯ä¹¦
			if [[ ${Custom_Sign} == "YES" ]]; then
				xcodebuild archive -workspace "${Workspace_Path}" \
							   -scheme "${Scheme_Name}" \
							   -archivePath "${Xcarchive_path}" \
							   -configuration "${Configuration}" \
							   PROVISIONING_PROFILE="${Profile_Name}" \
							   CODE_SIGN_IDENTITY="${Sign_Identity}" \
							   >> ${Log_path}
		    else
				xcodebuild archive -workspace "${Workspace_Path}" \
							   -scheme "${Scheme_Name}" \
							   -archivePath "${Xcarchive_path}" \
							   -configuration "${Configuration}" \
							   >> ${Log_path}
			fi
			
	
		else
			# ç¼–è¯‘å‰æ¸…ç†å·¥ç¨‹
			xcodebuild clean -configuration "${Configuration}" -alltargets >> ${Log_path}
	
			if [[ ${Custom_Sign} == "YES" ]]; then
				xcodebuild archive -project "${Xcodeproj_Path}" \
				                   -scheme "${Scheme_Name}" \
				                   -archivePath "${Xcarchive_path}" \
		   		                   -configuration "${Configuration}" \
				                   PROVISIONING_PROFILE="${Profile_Name}" \
				                   CODE_SIGN_IDENTITY="${Sign_Identity}"\
				                   >> ${Log_path}
		    else
		    	xcodebuild archive -project "${Xcodeproj_Path}" \
			                   -scheme "${Scheme_Name}" \
			                   -archivePath "${Xcarchive_path}" \
				                   -configuration "${Configuration}" \
			                   >> ${Log_path}
		    fi
	
		fi

* ##### å¯¼å‡ºIPAåŒ…


		xcodebuild -exportArchive -archivePath "${Xcarchive_path}" -exportPath "${IPA_Archiving_Path}" -exportOptionsPlist "${ExportOptionsPlistPath}" >> ${Log_path}

	Xcarchive_pathæŒ‡å‘ä¸Šä¸€æ­¥æ‰“åŒ…ç”Ÿæˆçš„`*.xcarchive`æ–‡ä»¶è·¯å¾„ï¼›IPA\_Archiving\_PathæŒ‡å‘å¯¼å‡ºçš„`*.ipa`æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼›ExportOptionsPlistPathå¯¹åº”`ExportOptions.plist`æ–‡ä»¶è·¯å¾„ï¼ŒExportOptions.plistæ˜¯ä½¿ç”¨xcodebuild -exportArchiveæŒ‡ä»¤å¯¼å‡ºipaåŒ…æ—¶éœ€è¦æŒ‡å®šçš„é…ç½®æ–‡ä»¶
	
	![ExportOptions.png](https://upload-images.jianshu.io/upload_images/1429982-78f888751b7ab8a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/440)

 * **compileBitcode**ï¼šä¸ä¸Šæ¶App Storeï¼ŒXcodeæ˜¯å¦å¯ç”¨Bitcodeé‡æ–°ç¼–è¯‘ï¼Œé»˜è®¤ä¸ºYESã€‚
 * **method**ï¼šå½’æ¡£ç±»å‹ï¼ŒåŒ…æ‹¬app-storeã€ad-hocã€
packageã€enterpriseã€developmentä»¥åŠdeveloper-idã€‚
 * **provisioningProfiles**ï¼šæ‰“åŒ…è¯ä¹¦ä¿¡æ¯ï¼ŒåŒ…å«çš„å­—å…¸ä¿¡æ¯æ ¼å¼ï¼š<keyä¸ºApp ID>:<valueä¸ºå¯¹åº”çš„profileæ–‡ä»¶å>ã€‚
 * **uploadBitcode**ï¼šä¸Šçº¿App Storeæ˜¯å¦å¼€å¯Bitcodeï¼Œé»˜è®¤ä¸ºYESã€‚
 * **uploadSymbols**ï¼šä¸Šçº¿App Storeï¼Œæ˜¯å¦å¼€å¯ç¬¦å·åºåˆ—åŒ–ï¼Œè¿™æ˜¯ä¸æŸ¥crashç›¸å…³çš„ï¼Œé»˜è®¤ä¸ºYESã€‚

	å…³äºæ›´å¤šçš„xcodebuildæŒ‡ä»¤ï¼Œå¯ä»¥é€šè¿‡`xcodebuild -help`æŸ¥çœ‹ã€‚

* ##### å…¶ä»–
å…¶ä»–éƒ¨åˆ†è¿˜åŒ…æ‹¬Gitä»£ç ç®¡ç†ã€IPAåŒ…ä¸Šä¼ ã€æ— æ•ˆèµ„æºåˆ é™¤ç­‰ï¼Œéƒ½å¯ä»¥ç›´æ¥é€šè¿‡NSTaskæ‰§è¡Œè„šæœ¬å‘½ä»¤å®ç°ï¼Œæ¯”å¦‚æ‹‰å–Gitä»£ç ï¼š`git pull origin`ï¼Œå½“ç„¶å‰ææ˜¯ä½ æœ¬åœ°çš„Gitå·²ç»é…ç½®ä¸ºå…å¯†æ“ä½œã€‚
å¦‚æœä½ æ˜¯ä½¿ç”¨SourceTreeè¿›è¡ŒGitç®¡ç†ï¼Œè€Œä¸”æ˜¯httpæ¨¡å¼ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·è®¾ç½®å…å¯†æ“ä½œï¼Œç¬¬3æ­¥å°†è¿œç¨‹ä»“åº“è·¯å¾„ç¼–è¾‘ä¸º `http://ç”¨æˆ·å:å¯†ç @ä»“åº“åœ°å€` è¿™æ ·çš„æ–¹å¼ï¼›å½“ç„¶å¦‚æœä½ æ˜¯SSHæ¨¡å¼ï¼Œé‚£ä¹ˆæœ¬èº«å°±æ”¯æŒå…å¯†ç æ“ä½œäº†ã€‚
![SourceTree.png](https://upload-images.jianshu.io/upload_images/1429982-c1cc63292476ca7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000)

	ä¸Šä¼ IPAåŒ…ã€‚<br>
æˆ‘è¿™é‡Œæ‰“çš„æ˜¯ä¼ä¸šåŒ…ï¼Œæ‰€ä»¥åªè¦å°†ipaæ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šæœåŠ¡å™¨å°±èƒ½å¤Ÿä¸‹è½½äº†ï¼ˆæƒ³äº†è§£æ›´å¤šå…³äºä¼ä¸šåŒ…çš„ä¸‹è½½ä¿¡æ¯ï¼Œå¯ä»¥å‚ç…§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« [iOSå¦‚ä½•éƒ¨ç½²ä¼ä¸šåŒ…ï¼Œä»¥ä¾›ä»–äººä¸‹è½½](http://lele8446.top/2016/03/18/iOSå¦‚ä½•éƒ¨ç½²ä¼ä¸šåŒ…/)ï¼‰ã€‚ä¸€å¼€å§‹æƒ³ç€å°†è‡ªåŠ¨ä¸Šä¼ ä¹Ÿé›†æˆåˆ°æ‰“åŒ…ç¨‹åºå†…ï¼Œä½†æœ€åå‘ç°è¿™æ¶‰åŠåˆ°å†…ç½‘é—´ä¸åŒæœåŠ¡å™¨ä»¥åŠè´¦å·éªŒè¯è¿‡ç¨‹ï¼Œå¤ªè¿‡å¤æ‚æš‚æ—¶å°†è¿™ä¸€éƒ¨åˆ†é˜‰å‰²äº†â€¦â€¦

### å†™åœ¨æœ€å
ä»¥ä¸Šä¾¿æ˜¯ä¸€é”®æ‰“åŒ…ç³»ç»Ÿçš„åŠŸèƒ½è®²è§£ï¼Œæƒ³äº†è§£æ›´å¤šå¯ä»¥æŸ¥çœ‹[æºç ](https://github.com/lele8446/CJShellDemo)<br><br>
  **[CJShellDemo](https://github.com/lele8446/CJShellDemo)** è¯´æ˜ï¼š<br>
 [ArchiveSource](https://github.com/lele8446/CJShellDemo/tree/master/ArchiveSource "ArchiveSource") ä¸€é”®æ‰“åŒ…ç¨‹åºèµ„æº<br>
 [CrashScript](https://github.com/lele8446/CJShellDemo/tree/master/CrashScript "CrashScript") çº¿ä¸ŠcrashæŸ¥æ‰¾è„šæœ¬<br>
 [ReleaseDir](https://github.com/lele8446/CJShellDemo/tree/master/ReleaseDir "ReleaseDir") Xcodeæ‰“åŒ…è„šæœ¬




æ¬¢è¿ç‚¹èµä»¥åŠGitHub StarğŸ‘